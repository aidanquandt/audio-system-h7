# OpenOCD config for STM32H745I-DISCO dual-core (ST-Link DAP)
#
# Uses stlink-dap.cfg (not stlink.cfg) so OpenOCD drives the DAP directly
# instead of through the HLA high-level API.  HLA mode cannot create a second
# GDB server for the CM4 core; DAP mode has no such restriction.
source [find interface/stlink-dap.cfg]
transport select dapdirect_swd

# Chip / core setup --------------------------------------------------------
set CHIPNAME stm32h745xih6
set DUAL_CORE 1   ;# creates both cpu0 (CM7, AP0) and cpu1 (CM4, AP3)

source [find target/stm32h7x_dual_bank.cfg]

reset_config srst_only

# Speed up after connect
$_CHIPNAME.cpu0 configure -event reset-init {
    adapter speed 4000
}
